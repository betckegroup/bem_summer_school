
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Hierarchical (\(\mathcal{H}\)-)Matrices &#8212; BEM Summer School - Lecture Notes</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Fast Multipole Methods" href="fmm.html" />
    <link rel="prev" title="Tree partitioning" href="partitioning.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">BEM Summer School - Lecture Notes</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    BEM Summer School Lecture Notes
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Practical BEM
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="discretisation.html">
   Discretising boundary integral operators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_system_solve.html">
   Solving the linear system
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="implementation.html">
   Implementational remarks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laplace_interior_dirichlet.html">
   Solving a Laplace problem with Dirichlet boundary conditions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reentrant_cube_capacity.html">
   Computing the capacity of a cube with a re-entrant corner
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="maxwell_screen.html">
   Electromagnetic scattering from flat screens
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Fast direct solvers
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="low_rank_compression.html">
   Low rank compressibility
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="partitioning.html">
   Tree partitioning
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Hierarchical (
   <span class="math notranslate nohighlight">
    \(\mathcal{H}\)
   </span>
   -)Matrices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fmm.html">
   Fast Multipole Methods
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/hmatrices.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/hmatrices.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#from-block-cluster-trees-to-mathcal-h-matrices">
   From block-cluster trees to
   <span class="math notranslate nohighlight">
    \(\mathcal{H}\)
   </span>
   -matrices.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mathcal-h-matrix-operations">
   <span class="math notranslate nohighlight">
    \(\mathcal{H}\)
   </span>
   -matrix operations
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Hierarchical (\mathcal{H}-)Matrices</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#from-block-cluster-trees-to-mathcal-h-matrices">
   From block-cluster trees to
   <span class="math notranslate nohighlight">
    \(\mathcal{H}\)
   </span>
   -matrices.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mathcal-h-matrix-operations">
   <span class="math notranslate nohighlight">
    \(\mathcal{H}\)
   </span>
   -matrix operations
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="hierarchical-mathcal-h-matrices">
<h1>Hierarchical (<span class="math notranslate nohighlight">\(\mathcal{H}\)</span>-)Matrices<a class="headerlink" href="#hierarchical-mathcal-h-matrices" title="Permalink to this headline">#</a></h1>
<p>In this section we will discuss hierarchical matrices (or <span class="math notranslate nohighlight">\(\mathcal{H}\)</span>-matrices). These allow the representation of and matrix vector products with the matrix of Green’s functions interactions with a complexity of <span class="math notranslate nohighlight">\(\mathcal{O}(N\log N)\)</span>, where <span class="math notranslate nohighlight">\(N\)</span> is the number of evaluation points.</p>
<p>Another nice feature of <span class="math notranslate nohighlight">\(\mathcal{H}\)</span>-matrices is that it is straight forward to design algorithms for an approximate <span class="math notranslate nohighlight">\(LU\)</span> decomposition and approximate inverse of these matrices with also near-linear complexity.</p>
<p>The disadvantage of <span class="math notranslate nohighlight">\(\mathcal{H}\)</span>-matrices is that compared to Fast Multipole or <span class="math notranslate nohighlight">\(\mathcal{H}^2\)</span> matrix techniques they do not have linear complexity (the <span class="math notranslate nohighlight">\(\log\)</span> factor becomes important for very large problems), and they tend to have also in practice larger memory requirements than these techniques.</p>
<p>Nevertheless, the algorithmic implementation is very simple and parallelisation is easy. This is why they are still very popular. Moreover, in many practical applications it seems the case that also for oscillatory problems they keep good performance into the medium wavenumber regime (though their asymptotic complexity is not optimal here).</p>
<p>In the literature <span class="math notranslate nohighlight">\(\mathcal{H}\)</span>-matrix technqiues are also often called ACA methods. The historical reason is that <span class="math notranslate nohighlight">\(\mathcal{H}\)</span>-matrices are often implemented using adaptive cross approximation. Nevertheless, this is an inaccurate description as ACA is merely the algorithm that low-rank compresses the blocks in an <span class="math notranslate nohighlight">\(\mathcal{H}\)</span>-matrix. Other low-rank compression techniques can equally be applied.</p>
<section id="from-block-cluster-trees-to-mathcal-h-matrices">
<h2>From block-cluster trees to <span class="math notranslate nohighlight">\(\mathcal{H}\)</span>-matrices.<a class="headerlink" href="#from-block-cluster-trees-to-mathcal-h-matrices" title="Permalink to this headline">#</a></h2>
<p><span class="math notranslate nohighlight">\(\mathcal{H}\)</span>-matrices are algebraic structures operating on block-cluster trees. Assume we have target and source index sets <span class="math notranslate nohighlight">\(I\)</span> and <span class="math notranslate nohighlight">\(J\)</span>, associated cluster trees <span class="math notranslate nohighlight">\(T_I\)</span> and <span class="math notranslate nohighlight">\(T_J\)</span>, and block-cluster tree <span class="math notranslate nohighlight">\(T_{I\times J}\)</span>.</p>
<p>Formally, the set <span class="math notranslate nohighlight">\(\mathcal{H}(T_{I\times J}, k)\)</span> of <span class="math notranslate nohighlight">\(\mathcal{H}\)</span>-matrices over the block-cluster tree <span class="math notranslate nohighlight">\(T_{I\times J}\)</span> can be defined as</p>
<div class="math notranslate nohighlight">
\[
\mathcal{H}(T_{I\times J}, k) := \{A\in\mathbb{C}^{I\times J}: \text{rank}(A_{I_\tau, J_\nu}) &lt; k\text{ if } \tau\times\nu \text{ is admissible leaf of } T_{I\times J}\}.
\]</div>
<p>To compress a given matrix <span class="math notranslate nohighlight">\(A\)</span> over a block-cluster tree into a compressed <span class="math notranslate nohighlight">\(\mathcal{H}\)</span>-matrix we do the following.</p>
<ul class="simple">
<li><p>If the node <span class="math notranslate nohighlight">\(\tau\times \nu\)</span> is not admissible then <span class="math notranslate nohighlight">\(\mathcal{H}_{\tau\times\nu}(A) := A[I_\tau, J_\nu]\)</span>, that is the <span class="math notranslate nohighlight">\(\mathcal{H}\)</span>-matrix stores the direct dense representation of the interactions between <span class="math notranslate nohighlight">\(I_\tau\)</span> and <span class="math notranslate nohighlight">\(J_\nu\)</span>.</p></li>
<li><p>If the node <span class="math notranslate nohighlight">\(\tau\times \nu\)</span> is admissible then <span class="math notranslate nohighlight">\(\mathcal{H}_{\tau\times\nu}(A):= CZ^H\)</span>, where <span class="math notranslate nohighlight">\(A[I_\tau, J_{\nu}]\approx CZ^H\)</span> is a low-rank representation of rank at most <span class="math notranslate nohighlight">\(k\)</span>.</p></li>
</ul>
<p>In the below representation of a block-cluster tree every green box has a low-rank representation, and every red box has a dense representation.</p>
<p><img alt="hmatrix" src="_images/block_cluster_tree.png" /></p>
<p>This structure is algorithmically extremely simple. For low-rank compression ACA is often used as it only needs to look at a subset of the rows and columns of a matrix. The generation of an H-Matrix representation parallelises perfectly as all blocks are independent from each other. This also makes it easy to distribute blocks across parallel clusters.</p>
<p>Evaluating a matvec with a <span class="math notranslate nohighlight">\(\mathcal{H}\)</span>-matrix is straight forward. We simply iterate through all leaf blocks of the block-cluster tree, compute the local products and sum up the results. For low-rank blocks we evaluate the matvec as <span class="math notranslate nohighlight">\(y = (CZV^H)x = C(V^Hx)\)</span>. This guarantees that the local complexity is <span class="math notranslate nohighlight">\(\mathcal{O}(n_{min}k)\)</span>. Only for a small number of non-admissible blocks we have a locally quadratic complexity.</p>
<p>One can give an exact analysis of the memory requirements of <span class="math notranslate nohighlight">\(\mathcal{H}\)</span>-matrices. Here, we will not go into the technicalities. For typical applications we obtain a memory complexity and complexity of matrix-vector products of <span class="math notranslate nohighlight">\(\mathcal{O}(N\log N)\)</span>. Compare to standard dense matrices, which have a memory and matvec complexity of <span class="math notranslate nohighlight">\(\mathcal{O}(N^2)\)</span>. This allows us to efficiently treat problems with millions of unknowns.</p>
<p>The global storage and matvec cost scales like <span class="math notranslate nohighlight">\(\mathcal{O}(N\log N)\)</span> for typical scenarios. This compares extremely favourably with dense matrix formats that require <span class="math notranslate nohighlight">\(\mathcal{O}(N^2)\)</span> operations.</p>
</section>
<section id="mathcal-h-matrix-operations">
<h2><span class="math notranslate nohighlight">\(\mathcal{H}\)</span>-matrix operations<a class="headerlink" href="#mathcal-h-matrix-operations" title="Permalink to this headline">#</a></h2>
<p>It is possible to define the usual matrix addition and multiplication operations over <span class="math notranslate nohighlight">\(\mathcal{H}\)</span>-matrices. The idea is based on using the recursive block-structure until on the leaf level we are dealing with operations on local low-rank or dense matrices. However, if we add two low-rank matrices of rank at most <span class="math notranslate nohighlight">\(k\)</span> the result will have a rank bounded by <span class="math notranslate nohighlight">\(2k\)</span>. So we need to recompress to achieve rank <span class="math notranslate nohighlight">\(k\)</span> again.</p>
<p>With multiplication and addition operations available we can define an approximate <span class="math notranslate nohighlight">\(\mathcal{H}\)</span>-matrix inverse.</p>
<p>Recall that we can write the inverse of a matrix</p>
<div class="math notranslate nohighlight">
\[\begin{split}
M = \begin{bmatrix}M_{11} &amp; M_{12} \\ 
                   M_{21} &amp; M_{22}
    \end{bmatrix}
\end{split}\]</div>
<p>as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
M = \begin{bmatrix}M_{11}^{-1} + M_{11}^{-1}M_{12}S^{-1}M_{21}M_{11}^{-1} &amp; -M_{11}^{-1}M_{12}S^{-1}\\ -S^{-1}M_{21}M_{11}^{-1} &amp; S^{-1}
     \end{bmatrix}
\end{split}\]</div>
<p>with <span class="math notranslate nohighlight">\(S := M_{22} - M_{21}M_{11}^{-1}M_{12}\)</span>.</p>
<p>The idea is to recursively apply this inversion to an <span class="math notranslate nohighlight">\(\mathcal{H}\)</span>-matrix$, where at the lowest level we only require inverses of non-admissible blocks and matrix products/additions with low-rank matrices.</p>
<p>In a similar manner it is possible to recursively define a <span class="math notranslate nohighlight">\(\mathcal{H}\)</span>-matrix <span class="math notranslate nohighlight">\(LU\)</span> decomposition.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="partitioning.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Tree partitioning</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="fmm.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fast Multipole Methods</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Timo Betcke<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>